"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}var __awaiter=this&&this.__awaiter||function(t,e,i,r){return new(i||(i=Promise))(function(s,n){function a(t){try{u(r.next(t))}catch(t){n(t)}}function o(t){try{u(r.throw(t))}catch(t){n(t)}}function u(t){t.done?s(t.value):new i(function(e){e(t.value)}).then(a,o)}u((r=r.apply(t,e||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});var utils_1=require("./utils"),Carousel=function(){function t(e,i){_classCallCheck(this,t),this._timeout=!1,this._stop=!1,this._paused=!1,this._time=0,this._running=!1;if(this.options=Object.assign({},{autoplay:0,prev:!0,next:!0,progress:!1,loop:!1},i),this.carousel=e,this.controller=this.carousel.querySelector(".carousel__controller"),this.items=this.carousel.querySelectorAll(".carousel__items .item"),this.nodes=Array.from(this.items),this.maxLength=this.items.length,this.maxArrayLength=this.maxLength-1,this.maxLength<=1)throw new Error("You must have at least two items in your carousel!");this.carousel.querySelector(".carousel__items .item.active")||this.items[0].classList.add("active"),this.activeItem=this.carousel.querySelector(".carousel__items .item.active"),this.buildHeight(),this.createKey(),this.initCtrl()}return _createClass(t,[{key:"initCtrl",value:function(){return __awaiter(this,void 0,void 0,regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.controller){t.next=2;break}throw new Error("You must have a controller element if you want to use controlls!");case 2:if(!this.options.progress){t.next=5;break}return t.next=5,this.createProgress();case 5:if(!this.options.prev||!this.controller){t.next=10;break}return t.next=8,this.createPrev();case 8:this.prevCtrl=this.controller.querySelector(".prev"),this.prevCtrl.addEventListener("click",function(){e.stop(),e.prevItem()});case 10:if(!this.options.next||!this.controller){t.next=15;break}return t.next=13,this.createNext();case 13:this.nextCtrl=this.controller.querySelector(".next"),this.nextCtrl.addEventListener("click",function(){e.stop(),e.nextItem()});case 15:this.options.autoplay&&("number"!=typeof this.options.autoplay?console.error("Autoplay must be type of number!"):this.options.autoplay<=500?console.error("Autoplay must be higher then 500!"):this.autoplay());case 16:case"end":return t.stop()}},t,this)}))}},{key:"mouseOver",value:function(){console.log("PAUSE")}},{key:"mouseOut",value:function(){console.log("START")}},{key:"read",value:function(){return(new Date).getTime()-this._time}},{key:"autoplay",value:function(){this._timeout=this.options.autoplay,this.autoplayNext()}},{key:"pause",value:function(){if(!this._paused||this._running){var t=(new Date).getTime()-this._time;this._timeout=Math.round(Number(this._timeout)-t)+1,this._paused=!0,this._running=!1,this._time=0}}},{key:"play",value:function(){!this._paused&&this._running||(this._paused=!1,this.autoplayNext())}},{key:"autoplayNext",value:function(){return __awaiter(this,void 0,void 0,regeneratorRuntime.mark(function t(){var e,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._running){t.next=2;break}return t.abrupt("return");case 2:this._running=!0,this._time=(new Date).getTime(),e=this.nodes.indexOf(this.activeItem),this.options.progress&&this.startProgress(e),i=0;case 7:if(i===Math.round(Number(this._timeout)/100)){t.next=17;break}return t.next=10,utils_1.timer(100);case 10:if(!this._stop&&!this._paused){t.next=12;break}return t.abrupt("return");case 12:if(!document.hidden){t.next=14;break}return t.abrupt("continue",7);case 14:i++,t.next=7;break;case 17:this._running=!1,this._timeout=this.options.autoplay,e!==this.maxArrayLength&&(this.nextItem(),this.autoplayNext()),this.options.loop&&e===this.maxArrayLength&&(this.nextItem(),this.autoplay());case 21:case"end":return t.stop()}},t,this)}))}},{key:"stop",value:function(){var t=this;this._stop=!0,this._running=!1,this.options.autoplay&&(clearTimeout(this._call),this._call=setTimeout(function(){t.autoplay()},1e3))}},{key:"createKey",value:function(){for(var t=0;t<this.maxLength;t++)this.items[t].setAttribute("index",t.toString())}},{key:"buildHeight",value:function(){for(var t=0,e=0;e<this.maxLength;e++){var i=this.items[e].getElementsByClassName("inner")[0].offsetHeight;i>t&&(t=i)}this.carousel.getElementsByClassName("carousel__items")[0].style.height="".concat(t,"px")}},{key:"createProgress",value:function(){var t=document.createElement("div");t.classList.add("progress");for(var e=this.controller.appendChild(t),i=0;i<this.maxLength;i++){var r=document.createElement("div");r.classList.add("item");var s=document.createElement("div");r.appendChild(s),e.appendChild(r)}}},{key:"startProgress",value:function(t){return __awaiter(this,void 0,void 0,regeneratorRuntime.mark(function e(){var i,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=Math.round(Number(this._timeout)/Number(this.options.autoplay)*100),r=100===i?0:-1*(i-100);case 2:if(!(r<=100)){e.next=14;break}return e.next=5,utils_1.timer(Number(this.options.autoplay)/100);case 5:if(this._stop&&this.moveProgress(0,t),!document.hidden){e.next=8;break}return e.abrupt("continue",2);case 8:if(!this._stop&&!this._paused){e.next=10;break}return e.abrupt("break",14);case 10:this.moveProgress(r,t),r++,e.next=2;break;case 14:case"end":return e.stop()}},e,this)}))}},{key:"moveProgress",value:function(t,e){var i=this.controller.querySelectorAll(".progress .item")[e],r=i.getElementsByTagName("div")[0];i.classList.remove("transition"),r.style.width="".concat(t,"%"),100===t&&(i.classList.add("transition"),r.style.width="0%")}},{key:"createPrev",value:function(){var t=document.createElement("div");t.classList.add("prev"),"string"==typeof this.options.prev?t.innerHTML=this.options.prev:t.innerText="←",this.controller.appendChild(t)}},{key:"createNext",value:function(){var t=document.createElement("div");t.classList.add("next"),"string"==typeof this.options.next?t.innerHTML=this.options.next:t.innerText="→",this.controller.appendChild(t)}},{key:"nextItem",value:function(){if(!document.hidden){this.activeItem.classList.remove("active");var t=this.nodes.indexOf(this.activeItem),e=t===this.maxArrayLength?0:t+1,i=this.items[e];i.classList.add("active"),this.activeItem=i}}},{key:"prevItem",value:function(){if(!document.hidden){this.activeItem.classList.remove("active");var t=this.nodes.indexOf(this.activeItem),e=t-1<0?this.maxArrayLength:t-1,i=this.items[e];i.classList.add("active"),this.activeItem=i}}}]),t}();function timer(t){return new Promise(function(e){return setTimeout(e,t)})}exports.default=Carousel,Object.defineProperty(exports,"__esModule",{value:!0}),exports.timer=timer;
//# sourceMappingURL=carousel.min.js.map
